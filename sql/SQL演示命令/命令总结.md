# 一、查询命令
### 0、创建数据库
```sql
create database if not exists fruit_db;
```
### 1、使用数据库
```sql
use fruit_db;
```
### 2、创建一个表单：
```sql
-- 1. 创建表（补充 IF NOT EXISTS 避免重复创建报错）
CREATE TABLE IF NOT EXISTS fruit(
    id INT PRIMARY KEY AUTO_INCREMENT,
    name VARCHAR(20),
    type ENUM('浆果','仁果','瓜果'),
    season ENUM('春','夏','秋','冬'),
    price DECIMAL(5,2),
    date_sale DATE
);

```
### 3、向这个表单插入数据
```sql
-- 2. 批量插入数据（修正语法错误）
INSERT INTO fruit(
    name,
    type,
    season,
    price,
    date_sale
) VALUES
    ('葡萄','浆果','夏',20.00,'2023-12-01'),   -- 每条数据单独用()包裹，逗号分隔
    ('柿子','浆果','秋',10.00,'2023-01-01'),
    ('橘子','浆果','秋',8.00,'2023-06-01'),
    ('山竹','仁果','夏',12.00,'2023-09-01'),
    ('苹果','仁果','秋',5.00,'2023-10-01'),
    ('梨子','仁果','秋',6.00,'2023-11-01'),
    ('西瓜','瓜果','夏',15.00,'2023-07-01'),
    ('菠萝','瓜果','夏',12.00,'2023-09-01'),
    ('香瓜','瓜果','夏',18.00,'2023-08-01'),
    ('哈密瓜','瓜果','秋',25.00,'2023-08-01');  -- 最后一条末尾只有分号，无多余逗号
```

### 3、select条件查询
上面都是无脑查询，现在，我想要查询单价大于10元的所有水果信息。怎嘛办？
```sql
# 1.查询单价大于10元的所有水果信息
select *
from fruit 
where price > 10;

# 2.查询单价在10元到15元之间的所有水果信息
select name 
from fruit 
where price between 10 and 15;
```


### 4、内置函数
```sql
SUM()、MAX()、MIN()、AVG()、count()

select 
    sum(price) as 总金额,
    max(price) as 最高金额,
    min(price) as 最低金额,
    avg(price) as 平均金额,
    count(*) as 水果数量
from 
    fruit;

-- +-----------+--------------+--------------+--------------+--------------+
-- | 总金额     | 最高金额     | 最低金额     | 平均金额     | 水果数量     |
-- +-----------+--------------+--------------+--------------+--------------+
-- |    131.00 |        25.00 |         5.00 |    13.100000 |           10 |
-- +-----------+--------------+--------------+--------------+--------------+
-- 1 row in set (0.01 sec)

```
特点
 只能用于`select、order by、having`这3个子句，不能用于`where、group by`等其他子句
  王哥不行hh


### 5、分组查询
注意，这里用group by进行分组。`含义是，某一列的相同值会被分为一组。`然后对这些组进行操作。

#### 5.1查询分组下的具体的水果名
```sql
select type '类型' , GROUP_CONCAT(name) '该分组下的具体水果名' 
from fruit 
group by type;
```
-- +---------+---------------------------------+
-- | 类型    | 该分组下的具体水果名            |
-- +---------+---------------------------------+
-- | 浆果    | 葡萄,柿子,橘子                 |
-- | 仁果    | 山竹,苹果,梨子                 |
-- | 瓜果    | 西瓜,菠萝,香瓜,哈密瓜         |
-- +---------+---------------------------------+
-- 3 rows in set (0.00 sec)

> 可以使用group_concat()函数查看分组中的`其他字段的所有信息`,这里的`GROUP_CONCAT(name)`表示查看该分组下的所有水果名。

#### 5.2查询分组下有多少种水果？
```sql
select type '类型' , count(name) '该分组下的水果有几种？' 
from fruit 
group by type;
```

#### 5.3查询春夏秋冬各有有多少种水果？
```sql
select season '季节' , GROUP_CONCAT(name) '春夏秋冬各有哪几种水果？' 
from fruit 
group by season;
```

### 6、分组查询的条件having

where只能用于select子句的条件查询，having用于group的条件子句

```sql
# 3.查询类型分组下，种类大于3的水果有多少种？

select type '类型' , GROUP_CONCAT(name) '该分组下的具体水果名' 
from fruit 
group by type 
having count(*) > 3;

-- +--------+--------------------------------+
-- | 类型   | 该分组下的具体水果名           |
-- +--------+--------------------------------+
-- | 瓜果   | 西瓜,菠萝,香瓜,哈密瓜          |
-- +--------+--------------------------------+
```

### 7、排序子句order by
查询单价大于10元的所有水果信息，按单价升序排序
```sql
-- 升序
select * 
from fruit 
where price > 10 
order by price asc;

-- 降序
select * 
from fruit 
where price > 10 
order by price desc;
```

### 8、限制行数limit
limit
 限制行数
  语法 limit m , n
   代表只显示从查询结果的m起的n条结果
   默认是m=0

```sql
select * 
from fruit 
where price > 10 
order by price asc;
limit 3
```

## 同为条件查询，where子句和having子句的区别？

### 1.作用对象不同：
- where
  where子句在`数据分组之前起作用`，用于筛选从`原始从数据库中读取的数据行`。它基于表中的列进行条件过滤，决定哪些行能够进入后续的处理阶段，例如聚合计算等。
  作用于原始的总数据行

- having
  having子句在`数据分组之后起作用`，用于`筛选分组后的结果集`。它通常与聚合函数一起使用，根据聚合结果进行条件过滤。
  作用于分组后的子数据组

### 2.语法及使用场景不同：

- where
  where子句可以使用表中的`列名`、`常量`、`表达式`以及比较运算符、逻辑运算符等进行条件判断。
  例如：WHERE column_name > 10。`适用于对原始数据进行基本的筛选`，比如筛选出特定日期范围内的记录、符合特定条件的客户信息等。

- having
  having子句`通常结合聚合函数使用`，例如：HAVING AVG(column_name) > 50。`适用于在对数据进行分组并计算聚合值后`，根据`聚合结果进行进一步筛选的场景`，比如找出平均销售额大于一定值的产品类别等

### 3.性能影响不同：

 - 一般来说，在可以使用where子句进行筛选的情况下`优先使用where子句`，因为它在`数据分组之前进行筛选`，可以减少参与分组和聚合计算的数据量，从而提高查询性能。